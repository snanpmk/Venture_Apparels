<style>
  @import url("https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap");
  body {
    background: #f9f9f9;
  }
  .nav-pills {
    position: sticky;
    top: 0;
    /* Add any additional styling you need here */
  }

  /* Add a z-index to ensure the sticky items appear above other content */
  .nav-pills {
    z-index: 100;
  }
  @media (max-width: 767px) {
    body {
      height: calc(100vh - 56px);
      overflow-y: auto;
    }
  }
  @media (min-width: 768px) {
    .p-md-2 {
      padding: 2.5rem !important;
    }
  }
  .table > :not(caption) > * > * {
    padding: 1.5rem 1rem;
    background-color: var(--bs-table-bg);
    border-bottom-width: 1px;
    box-shadow: inset 0 0 0 9999px var(--bs-table-accent-bg);
  }

  .dropdown-menu {
    box-shadow: 0 1.5rem 4rem rgba(22, 28, 45, 0.12);
    padding: 1rem 1.5rem;
    min-width: 4rem;
    z-index: 10000000;
  }
  .dropdown-item {
    color: white;
  }
  .table-responsive {
    overflow-x: auto;
    min-width: auto;
  }

  .table-head {
    vertical-align: middle;
    text-align: center;
  }
  .table-row {
    vertical-align: middle;
    align-items: center;
  }

  .product-name {
    font-weight: 900;
    font-size: small;
    text-transform: uppercase;
  }
  .card {
    position: relative;
    display: flex;
    flex-direction: row;
    min-width: 22px;
    word-wrap: break-word;
    background-color: #fff;
    background-clip: border-box;
    border: 1px solid rgba(0, 0, 0, 0.125);
    margin-bottom: 4vh;
    border-radius: 1.5rem;
    .border-secondary,
    .border-secondary-active:active,
    .border-secondary-focus:focus,
    .border-secondary-hover:hover {
      border-color: #dedede !important;
    }
  }
  .shadow {
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1) !important;
  }
  .profile-tab-nav {
    border-right: 0.2px solid #d4d4d4;
  }

  .profile-tab-nav {
    min-width: 250px;
  }

  .tab-content {
    flex: 1;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .nav-pills a.nav-link {
    padding: 15px 20px;
    border-bottom: 1px solid #ddd;
    border-radius: 0;
    color: #333;
  }
  .nav-pills a.nav-link i {
    width: 20px;
  }

  .img-circle img {
    height: 100px;
    width: 100px;
    border-radius: 100%;
    border: 5px solid #fff;
  }
  .tabel-coloumn {
    vertical-align: middle;
  }
</style>
<style>
  .dropdown {
    position: relative;
    display: inline-block;
  }

  .dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 120px;
    box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
    z-index: 1;
  }

  .dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
  }

  .dropdown-content a:hover {
    background-color: #f1f1f1;
  }

  .show {
    display: block;
  }
  .returnModal {
    display: none; /* Hide the modal by default */
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;

    background-color: rgba(
      68,
      68,
      68,
      0.8
    ); /* Create a semi-transparent background overlay */
  }
  .view-link {
    color: rgb(0, 0, 0); /* Style for 'View' links */
  }

  .cancel-link {
    color: red; /* Style for 'Cancel order' links */
  }
  /* Modal Content */
  .modal-content {
    background-color: #fefefe;
    padding: 20px;
    width: fit-content;
    position: relative;
    box-shadow: 0 4px 8px 0 rgba(116, 116, 116, 0.053);
    border-radius: 1rem;
    margin: 0 auto;
  }
  @media (max-width: 767px) {
    /* Adjust styles for mobile view here */
    .modal-content {
      width: 80%; /* Adjust the width for smaller screens */
      padding: 10px; /* Reduce padding for smaller screens */
    }
    @media (max-width: 767px) {
      /* Adjust the maximum width for mobile view to 14rem */
      #comments {
        max-width: 14rem;
        width: 100%; /* You can adjust this as needed for responsiveness */
      }
    }
  }
  .copy-button {
    display: flex;
    justify-content: space-between;
    padding: 0 10px;
    align-items: center;
    display: none;
  }
  .copy-button input {
    width: 100%;
    height: 80%;
    border: none;
    outline: none;
    font-size: 16px;
    text-align: center;
    font-weight: 200;
  }

  .copy-button button {
    padding: 5px 20px;
    background-color: #1c212c;
    color: #fff;
    border: 1px solid transparent;
    border-radius: 0.2rem;
  }
</style>

<section class="py-3 my-3">
  <div class="container">
    <div class="bg-white shadow rounded-lg d-block d-sm-flex">
      <div class="profile-tab-nav border-right border-secondary">
        <div class="p-4">
          <div class="img-circle text-center mb-3">
            <img
              src="https://img.freepik.com/premium-vector/people-saving-money_24908-51569.jpg?w=740"
              alt="Image"
              class="shadow"
            />
          </div>
          <% if (address) { %>
          <h4 class="text-center"><%= address.fname %> <%= address.lname %></h4>
          <% } else { %>
          <p>No address found. Please add one to see.</p>
          <% } %>
        </div>
        <div
          class="nav flex-column nav-pills"
          id="v-pills-tab"
          role="tablist"
          aria-orientation="vertical"
        >
          <a
            class="nav-link active"
            id="account-tab"
            data-bs-toggle="pill"
            href="#account"
            role="tab"
            aria-controls="account"
            aria-selected="true"
          >
            <i class="fa fa-home text-center mr-1"></i>
            Account
          </a>
          <a
            class="nav-link"
            id="password-tab"
            data-bs-toggle="pill"
            href="#password"
            role="tab"
            aria-controls="password"
            aria-selected="false"
          >
            <i class="fa fa-key text-center mr-1"></i>
            Password
          </a>
          <a
            class="nav-link"
            id="security-tab"
            data-bs-toggle="pill"
            href="#security"
            role="tab"
            aria-controls="security"
            aria-selected="false"
          >
            <i class="fa fa-user text-center mr-1"></i>
            Security
          </a>
          <a
            class="nav-link"
            id="application-tab"
            data-bs-toggle="pill"
            href="#application"
            role="tab"
            aria-controls="application"
            aria-selected="false"
          >
            <i class="fa fa-tv text-center mr-1"></i>
            Shipping Address
          </a>
          <a
            class="nav-link"
            id="notification-tab"
            data-bs-toggle="pill"
            href="#notification"
            role="tab"
            aria-controls="notification"
            aria-selected="false"
          >
            <i class="fa fa-bell text-center mr-1"></i>
            View Orders
          </a>
          <a href="/logout" class="nav-link" id="notification-tab">
            <i class="fa fa-bell text-center mr-1"></i>
            Log Out
          </a>
          <a
            class="nav-link"
            id="password-tab"
            data-bs-toggle="pill"
            href="#referal"
            role="tab"
            aria-controls="password"
            aria-selected="false"
          >
            <i class="fa fa-key text-center mr-1"></i>
            Refer a friend
          </a>
        </div>
      </div>
      <div class="tab-content p-md-2" id="v-pills-tabContent">
        <div
          class="tab-pane fade show active"
          id="account"
          role="tabpanel"
          aria-labelledby="account-tab"
        >
          <h3 class="mb-4">Account Settings</h3>
          <% if (address) { %>
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="firstName" class="form-label">First Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="editFirstName"
                  value="<%= address.fname %>"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="lastName" class="form-label">Last Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="editLastName"
                  value="<%= address.lname %>"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input
                  type="text"
                  class="form-control"
                  id="editEmail"
                  value="<%= address.email %>"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="phoneNumber" class="form-label">Phone number</label>
                <input
                  type="text"
                  class="form-control"
                  id="editPhoneNumber"
                  value="<%= address.phoneNumber %>"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="company" class="form-label">Address</label>
                <input
                  type="text"
                  class="form-control"
                  id="editAddress"
                  value="<%= address.address %>"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="company" class="form-label">Country</label>
                <input
                  type="text"
                  class="form-control"
                  id="editCountry"
                  value="<%= address.country %>"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="company" class="form-label">State</label>
                <input
                  type="text"
                  class="form-control"
                  id="editState"
                  value="<%= address.state %>"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="company" class="form-label">Zip/Post</label>
                <input
                  type="text"
                  class="form-control"
                  id="editZipCode"
                  value="<%= address.zipcode %>"
                />
              </div>
            </div>
          </div>
          <div>
            <button
              id="submitAddressButton"
              data-address-id="<%= address._id %>"
              class="btn btn-primary"
            >
              Update
            </button>
            <button class="btn btn-success">Cancel</button>
          </div>
          <% } else { %>
          <p>No address found. Please add one to see.</p>
          <% } %>
        </div>
        <div
          class="tab-pane fade"
          id="password"
          role="tabpanel"
          aria-labelledby="password-tab"
        >
          <h3 class="mb-4">Password Settings</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="oldPassword" class="form-label">Old password</label>
                <input type="password" class="form-control" id="oldPassword" />
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="newPassword" class="form-label">New password</label>
                <input type="password" class="form-control" id="newPassword" />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="confirmPassword" class="form-label"
                  >Confirm new password</label
                >
                <input
                  type="password"
                  class="form-control"
                  id="confirmPassword"
                />
              </div>
            </div>
          </div>
          <div>
            <button class="btn btn-primary">Update</button>
            <button class="btn btn-light">Cancel</button>
          </div>
        </div>
        <div
          class="tab-pane fade"
          id="security"
          role="tabpanel"
          aria-labelledby="security-tab"
        >
          <h3 class="mb-4">Security Settings</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="login" class="form-label">Login</label>
                <input type="text" class="form-control" id="login" />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="twoFactorAuth" class="form-label"
                  >Two-factor auth</label
                >
                <input type="text" class="form-control" id="twoFactorAuth" />
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value=""
                    id="recovery"
                  />
                  <label class="form-check-label" for="recovery">
                    Recovery
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div>
            <button class="btn btn-primary">Update</button>
            <button class="btn btn-light">Cancel</button>
          </div>
        </div>
        <div
          class="tab-pane fade"
          id="application"
          role="tabpanel"
          aria-labelledby="application-tab"
        >
          <h3 class="mb-4">Shipping Address</h3>
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <% for (let i = 0; i < allAddress.length; i++) { %>
                <div class="card">
                  <div class="card-body">
                    <h5 class="card-title">
                      <% if (i === 0) { %> Default Address <% } else { %>
                      Address <%= i %> <% } %>
                    </h5>
                    <p class="card-text">
                      <%= allAddress[i].fname %> <%= allAddress[i].lname %>,
                    </p>
                    <p class="card-text">
                      <%= allAddress[i].address %>, <%= allAddress[i].state %>,
                      <%= allAddress[i].country %>
                    </p>
                    <p class="card-text">
                      <%= allAddress[i].phoneNumber %>, <%=
                      allAddress[i].zipcode %>
                    </p>
                  </div>
                </div>
                <% } %>
                <div class="card">
                  <div class="card-body">
                    <h4 style="padding: 3rem; font-weight: bold">
                      <a href="">Add Address</a>
                    </h4>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          class="tab-pane fade"
          id="notification"
          role="tabpanel"
          aria-labelledby="notification-tab"
        >
          <div class="table-responsive">
            <% allorders.forEach(function(order, index) { %>
            <div class="card mb-3" style="margin: 5px">
              <div class="card-body">
                <span
                  class="card-title badge rounded-pill <% if (order.status === 'processing') { %> bg-info <% } else if (order.status === 'shipped') { %> bg-warning <% } else if (order.status === 'delivered') { %> bg-success <% } else if (order.status === 'returned') { %> bg-danger <% } else if (order.status === 'returnPending') { %> bg-primary <% } else if (order.status === 'canceled') { %> bg-secondary <% } else if (order.status === 'cancelPending') { %> bg-dark <% } else { %> bg-secondary <% } %>"
                >
                  <% if (order.status === 'processing') { %> Processing <% }
                  else if (order.status === 'shipped') { %> Shipped <% } else if
                  (order.status === 'delivered') { %> Delivered <% } else if
                  (order.status === 'returned') { %> Returned <% } else if
                  (order.status === 'returnPending') { %> Return Pending <% }
                  else if (order.status === 'canceled') { %> Cancelled <% } else
                  if (order.status === 'cancelPending') { %> Cancel Pending <% }
                  else { %> Unknown <% } %>
                </span>
                <br />
                <% if (order.status === 'processing') { %> Your order is
                currently processing %> <% } else if (order.status ===
                'shipped') { %> Your order has been shipped on <%=
                order.date.toDateString() %> <% } else if (order.status ===
                'delivered') { %> Your order has been delivered on <%=
                order.date.toDateString() %> <% } else if (order.status ===
                'returned') { %> Your order has been returned on <%=
                order.date.toDateString() %> <% } else if (order.status ===
                'returnPending') { %> Your return request is pending %> <% }
                else if (order.status === 'canceled') { %> Your order has been
                canceled on <%= order.date.toDateString() %> <% } else if
                (order.status === 'cancelPending') { %> Your cancel request is
                pending %> <% } else { %> <% } %>
                <br />

                <% order.items.forEach(function(item) { %>
                <div
                  class="card mb-2"
                  style="margin-top: 1rem; background-color: #f9f9f9"
                >
                  <div class="card-body d-flex align-items-center">
                    <div class="card-body">
                      <div
                        class="d-md-flex justify-content-between align-items-center"
                      >
                        <div class="d-flex align-items-center">
                          <img
                            src="<%= item.product.image %>"
                            alt="<%= item.product.name %>"
                            width="70px"
                            class="img-thumbnail"
                          />

                          <div style="margin-left: 2rem">
                            <h6 class="card-title"><%= item.product.name %></h6>
                          </div>
                        </div>
                        <!-- Display price and quantity in mobile view -->
                        <div class="d-none d-md-block">
                          <p>Price: $<%= item.product.price %></p>
                          <p>Quantity:<%= item.quantity %></p>
                        </div>
                      </div>
                    </div>
                    <input
                      style="display: none"
                      type="checkbox"
                      class="return-checkbox return-item-checkbox"
                      data-order-id="<%= order._id %>"
                      data-item-id="<%= item.product.id %>"
                    />
                  </div>
                </div>

                <% }); %>

                <div style="display: flex; justify-content: space-between">
                  <div style="display: flex; flex-direction: column">
                    <p class="card-text">
                      Total Price: $<%= order.totalAmount %>
                    </p>
                    <p class="card-text">Status: <%= order.orderNumber %></p>
                  </div>

                  <div
                    style="
                      display: flex;
                      flex-direction: row;
                      align-items: center;
                    "
                  >
                    <div class="dropdown">
                      <button
                        class="btn btn dropdown-toggle"
                        type="button"
                        id="dropdownMenuButton-<%= order._id %>"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                      >
                        Details
                      </button>
                      <ul
                        class="dropdown-menu"
                        aria-labelledby="dropdownMenuButton-<%= order._id %>"
                      >
                        <% if (order.status === 'processing' || order.status ===
                        'shipped') { %>
                        <li>
                          <a
                            href="/order-details?id=<%= order._id %>"
                            class="dropdown-item view-link"
                            >View</a
                          >
                        </li>
                        <li>
                          <a
                            href="/cancel-order?id=<%= order._id %>"
                            class="dropdown-item cancel-link"
                            >Cancel order</a
                          >
                        </li>
                        <% } else { %>
                        <li>
                          <a
                            href="/order-details?id=<%= order._id %>"
                            class="dropdown-item view-link"
                            >View</a
                          >
                        </li>
                        <% } %>
                      </ul>
                    </div>

                    <% if (order.status === 'delivered' &&
                    order.returnExpiryDate && new Date(order.returnExpiryDate) >
                    new Date()) { %>
                    <div class="card-text">
                      <button
                        id="return-btn-<%= order._id %>"
                        class="return-btn btn"
                        style="color: red"
                        data-order-id="<%= order._id %>"
                        onclick="toggleReturnCheckboxes('<%= order._id %>')"
                      >
                        Return
                      </button>
                      <button
                        id="cancelReturn-btn-<%= order._id %>"
                        class="return-btn btn"
                        style="color: blue;display: none;"
                        data-order-id="<%= order._id %>"
                        onclick="disableReturnCheckBoxes('<%= order._id %>')"
                      >
                        cancel
                      </button>
                     
                    </div>
                    <button
                        id="returnSelectedItems-btn-<%= order._id %>"
                        class="return-selectedItems-btn btn"
                        style="display: none;color: red;"
                        data-order-id="<%= order._id %>"
                      >
                        Return Selected Items
                      </button>
                    
                    <% } else { %>

                    <div class="card-text">
                      <% if (!order.returnExpiryDate) { %> <% } else if (new
                      Date(order.returnExpiryDate) <= new Date()) { %> Your
                      return order has expired on <%=
                      order.returnExpiryDate.toDateString() %> <% } %>
                    </div>
                    <% } %>
                    <div id="returnModal-<%= order._id %>" class="returnModal">
                      <div class="modal-dialog modal-dialog-centered modal-lg">
                        <div class="modal-content" style="border-radius: 1rem">
                          <div>
                            <button
                              type="button"
                              class="btn-close"
                              data-dismiss="modal"
                              aria-label="Close"
                              onclick="closeReturnModal('<%= order._id %>')"
                            ></button>
                          </div>
                          <div class="modal-body pt-0">
                            <h5>Choose Return Reason</h5>
                            <form id="returnReasonForm">
                              <label>
                                <input
                                  type="radio"
                                  name="reason"
                                  value="Defective"
                                />
                                Defective </label
                              ><br />
                              <label>
                                <input
                                  type="radio"
                                  name="reason"
                                  value="Wrong Item"
                                />
                                Wrong Item </label
                              ><br />
                              <label>
                                <input
                                  type="radio"
                                  name="reason"
                                  value="Changed My Mind"
                                />
                                Changed My Mind </label
                              ><br />
                              <label>
                                <input
                                  type="radio"
                                  name="reason"
                                  value="Other"
                                />
                                Other </label
                              ><br />

                              <label for="comments">Comments:</label><br />
                              <textarea
                                id="comments"
                                name="comments"
                                rows="4"
                                cols="50"
                                style="max-width: inherit"
                              ></textarea
                              ><br />

                              <a
                                type="submit"
                                id="submitReturn"
                                class="btn btn-success"
                                onclick="submitReturnModal('<%= order._id %>')"
                              >
                                Confirm Return
                              </a>
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <% }); %>
          </div>
        </div>
        <div
          class="tab-pane fade"
          id="referal"
          role="tabpanel"
          aria-labelledby="referal-tab"
        >
          <h3 class="mb-4">Referral Offers</h3>
          <div class="container" style="vertical-align: middle">
            <div class="row justify-content-center mt-5">
              <div class="col-md-8">
                <div class="card">
                  <div class="card-body text-center">
                    <h5 class="card-title">Exciting Referral Offers</h5>
                    <div
                      style="
                        border: 2px dotted #000;
                        padding: 10px;
                        margin: 2rem;
                      "
                    >
                      <p class="card-text">
                        <a
                          class="btn"
                          style="text-decoration: none"
                          id="referLink"
                          >Click here to refer a friend</a
                        >
                      </p>
                    </div>
                    <div class="copy-button">
                      <input
                        id="copyvalue"
                        type="text"
                        readonly
                        value="fdsffdsfdsfds"
                      />
                      <button onclick="copyIt('copyvalue')" class="copybtn">
                        SHARE
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .card {
    border-radius: 0.2rem;
  }
</style>

<script>
  function toggleReturnCheckboxes(orderId) {
  const checkboxes = document.querySelectorAll(`input.return-checkbox[data-order-id="${orderId}"]`);
  checkboxes.forEach((checkbox) => {
    checkbox.style.display = checkbox.style.display === 'none' ? 'block' : 'none';
  });

  document.getElementById(`return-btn-${orderId}`).style.display="none"
  document.getElementById(`dropdownMenuButton-${orderId}`).style.display="none"
  document.getElementById(`returnSelectedItems-btn-${orderId}`).style.display="block"
  document.getElementById(`cancelReturn-btn-${orderId}`).style.display="block"
}

</script>
<script>
  function disableReturnCheckBoxes(orderId){
    const checkboxes = document.querySelectorAll(`input.return-checkbox[data-order-id="${orderId}"]`);
  checkboxes.forEach((checkbox) => {
    checkbox.style.display = checkbox.style.display === 'block' ? 'none' : 'block';
  });

  document.getElementById(`return-btn-${orderId}`).style.display="block"
  document.getElementById(`dropdownMenuButton-${orderId}`).style.display="block"
  document.getElementById(`returnSelectedItems-btn-${orderId}`).style.display="none"
  document.getElementById(`cancelReturn-btn-${orderId}`).style.display="none"
  }
</script>
<script>
  var addressId;
  function editAddress(id) {
    addressId = id;
    var emailInput = document.getElementById("editEmail");
    var firstNameInput = document.getElementById("editFirstName");
    var lastNameInput = document.getElementById("editLastName");
    var addressInput = document.getElementById("editAddress");
    var phoneNumberInput = document.getElementById("editPhoneNumber");
    var countryInput = document.getElementById("editCountry");
    var stateInput = document.getElementById("editState");
    var zipCodeInput = document.getElementById("editZipCode");
    // var useForBillingCheckbox = document.getElementById("editSameAddress"); // Add this line to declare useForBillingCheckbox variable

    const formData = {
      email: emailInput.value,
      firstName: firstNameInput.value,
      lastName: lastNameInput.value,
      address: addressInput.value,
      phoneNumber: phoneNumberInput.value,
      country: countryInput.value,
      state: stateInput.value,
      zipCode: zipCodeInput.value,
      // useForBilling: useForBillingCheckbox.checked,
    };

    fetch(`/submit-address/${addressId}`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify(formData),
    })
      .then((response) => {
        return response.json();
      })
      .then((data) => {
        console.log(data);
        window.location.reload();
        modal.style.display = "none";
      })
      .catch((error) => {
        console.error(error);
      });
  }

  document.addEventListener("DOMContentLoaded", function () {
    var submitBtn = document.getElementById("submitAddressButton");
    submitBtn.addEventListener("click", function () {
      var addressId = submitBtn.getAttribute("data-address-id");
      editAddress(addressId);
    });
  });
</script>


<script>
  function openReturnAlert(orderId) {
  Swal.fire({
    title: "Return Order",
    text: "Are you sure you want to return this order?",
    icon: "warning",
    showCancelButton: true,
    confirmButtonColor: "#3085d6",
    cancelButtonColor: "#d33",
    confirmButtonText: "Yes, return it!",
  }).then((result) => {
    if (result.isConfirmed) {
      // Get the selected reason and comments
      const selectedReason = document.querySelector(
        `#returnModal-${orderId} input[name="reason"]:checked`
      );

      if (!selectedReason) {
        // No reason selected, show an error message or perform necessary action
        alert("Please select a return reason before confirming.");
        return; // Stop further execution
      }

      // Get selected items
      const selectedItems = [];
      const checkboxes = document.querySelectorAll(
        `.return-checkbox[data-order-id="${orderId}"]:checked`
      );

      checkboxes.forEach((checkbox) => {
        selectedItems.push(checkbox.getAttribute("data-item-id"));
      });

      // Make the fetch request with the selected items as the body
      fetch(`/return-order/${orderId}`, {
        method: "POST", // Assuming you want to use POST method for sending data
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          selectedReason: selectedReason.value,
          selectedItems: selectedItems, // Pass the selected items
        }),
      }).then((response) => {
        if (response.ok) {
          Swal.fire("Returned!", "Your order has been returned.", "success");
        } else {
          // Handle the case where the server responds with an error
          Swal.fire("Error", "Failed to return the order.", "error");
        }
      });
    }
  });
}
  </script>



//
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    function openReturnModal(orderId) {
      const returnModal = document.getElementById(`returnModal-${orderId}`);
      $(returnModal).modal("show");
    }

    document
      .querySelectorAll(".return-selectedItems-btn[data-order-id]")
      .forEach(function (button) {
        button.addEventListener("click", function (event) {
          const orderId = event.target.getAttribute("data-order-id");
          openReturnModal(orderId);
        });
      });

    function submitReturnModal(orderId) {
      const modalId = `returnModal-${orderId}`;
      const modal = document.getElementById(modalId);

      // Get the selected reason
      // Get the selected radio button value
      const selectedReason = document.querySelector(
        `#${modalId} input[name="reason"]:checked`
      );

      // Check if a radio button is selected
      if (selectedReason) {
        // Access the value property to get the selected reason
        const reasonValue = selectedReason.value;
      } else {
      }

     
      if (!selectedReason) {
        // No reason selected, show an error message or perform necessary action
        alert("Please select a return reason before confirming.");
        return; // Stop further execution
      }

      if (modal) {
        $(modal).modal("hide");

        // // Now you can use 'selectedReason.value' and 'comments' as needed
        // console.log("Selected Reason:", selectedReason.value);
        // console.log("Comments:", comments);
      }
      openReturnAlert(orderId)
    }

    function closeReturnModal(orderId) {
      const modalId = `returnModal-${orderId}`;
      const modal = document.getElementById(modalId);
      if (modal) {
        $(modal).modal("hide");
      }
    }
  
</script>

<script>
  function copyIt(inputId) {
    let copyInput = document.querySelector(`#${inputId}`);
    copyInput.select();
    document.execCommand("copy");
    const copyBtn = document.querySelector(`#${inputId} + .copybtn`);
    copyBtn.textContent = "COPIED";
  }
</script>

<script>
  document
    .getElementById("referLink")
    .addEventListener("click", function (event) {
      event.preventDefault(); // Prevent the default link behavior
      console.log("testing");
      // Make a GET request to the /referlink URL
      fetch("/referlink", {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then((response) => {
          if (response.ok) {
            return response.json(); // Return the promise
          } else {
            // Handle errors here
            console.error("Error making GET request to /referlink");
          }
        })
        .then((data) => {
          // Handle a successful response here
          console.log(
            "GET request to /referlink was successful " + data.referralLink
          );

          // Replace the value of the input field with the referralLink
          document.getElementById("copyvalue").value = data.referralLink;

          // Show the section by changing the display property
          document.querySelector(".copy-button").style.display = "block";
        })
        .catch((error) => {
          // Handle network errors here
          console.error("Network error:", error);
        });
    });
</script>
